<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>Social Network Analysis in R</title>
    <meta charset="utf-8" />
    <meta name="author" content="Department of Defense Analysis" />
    <meta name="date" content="2019-06-13" />
    <script src="libs/htmlwidgets/htmlwidgets.js"></script>
    <script src="libs/jquery/jquery.min.js"></script>
    <link href="libs/datatables-css/datatables-crosstalk.css" rel="stylesheet" />
    <script src="libs/datatables-binding/datatables.js"></script>
    <link href="libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="libs/dt-core/js/jquery.dataTables.min.js"></script>
    <link href="libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
    <script src="libs/crosstalk/js/crosstalk.min.js"></script>
    <script src="libs/kePrint/kePrint.js"></script>
    <link href="libs/vis/vis.css" rel="stylesheet" />
    <script src="libs/vis/vis.min.js"></script>
    <script src="libs/visNetwork-binding/visNetwork.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Social Network Analysis in R
## CORE Lab
### Department of Defense Analysis
### 2019-06-13

---







# Background

--
Social network analysis (SNA) is commonly used to understand groups and social formations. 
--
**The focus of this methodology is the relationships among individuals, which influence a person's behavior above and beyond the influence of his or her individual attributes (Valente 2010). **
--
As such, SNA enables analysts to understand how social ties help to define, enable, and constrain the knowledge, reach, and capacities of actors within groups (Cunningham, Everton, and Murphy 2016).

--

While social network research is **not** exclusively dependent on software applications, these do increase the efficiency of researchers. Here we will focus on **R**.


---

# Goals

Here we will explore some of the key SNA features of the open-source programming language **R**, and a variety of packages - primarily **igraph** (https://igraph.org/r/) and **visNetwork** (https://datastorm-open.github.io/visNetwork/) - developed to work with relational data. Specifically, we will:

--
* Explore, structure, visualize, and analyze relational data with the **igraph** library.

--
* Build processes in **R** with **igraph** to streamline analysis.

--
* Create interactive visualizations with the **visNetwork** package.

--
* Please note that **statnet** (http://www.statnet.org/) is another commonly used package among social network analysts.

---

# Supplemental Packages

* **here** - A package to make it easier to find your files by constructing paths to your project's files.
* **tidyverse** - A collection of packages designed for data science. Users get packages such as dplyr, ggplot, purr, etc.  
* **purrr** - A useful tool for working with vectors. 
* **DT** - A "wrapper" of the JavaScript Library "DataTables". We will use it to build interactive data tables. 
* **kableExtra** - A package to help us build tables using HTML. 
* **emo** - A package that allows users to insert emoji into RMarkdown documents (like this one!). 
* **xaringan** - You're looking at it!

---

# Getting Started: Loading Data

Let's bring in data from an edgelist:


```r
read.csv(here::here("data/Familial.csv"), header = TRUE)
#familial &lt;- as.data.frame(read.csv(file="Familial.csv", header=TRUE))
```

&lt;br&gt;

<div id="htmlwidget-11cc83256d1f8bdcfabf" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-11cc83256d1f8bdcfabf">{"x":{"filter":"none","fillContainer":true,"data":[["Adonis","Adonis","Adonis","Bananas","Bananas","Bananas","Bananas","Bat G.","Bat G.","Big G.","Boots","Boots","Boots","Boots","Boxcar","Boxcar","Brains","Brains","Fat Boy","Fat Boy","Fat Boy","Slingshot","Freckles","Freckles","Ghost","Goldie","Goldie","Pookey","Icepick","Snake"],["Boxcar","Ghost","Jelly","Blue Eyes","Brains","Slingshot","Gremlin","Big G.","Blaze","Blaze","Fat Boy","Freckles","Icepick","Repo Girl","Ghost","Jelly","Slingshot","Gremlin","Freckles","Icepick","Repo Girl","Gremlin","Icepick","Repo Girl","Jelly","Pookey","O.G.","O.G.","Repo Girl","Sonny Black"],["Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial"]],"container":"<table class=\"cell-border stripe fill-container\">\n  <thead>\n    <tr>\n      <th>Source<\/th>\n      <th>Target<\/th>\n      <th>Relationship<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLenght":7,"autoWidth":false,"dom":"tp","order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script>


---

# Relationships Codebook

  * **Familial**: (person-to-person; i.e., one-mode) - Defined as any family connection through blood, adoption, or marriage.
  * **Financial**: person-to-person) - Defined as two actors, in reporting or intelligence, who are explicitly stated as transferring funds between one another for any purpose, legal or illegal. 
  * **Friendship**: (person-to-person) - Defined as two individuals who are explicitly stated as friends, or who are explicitly known as trusted confidants in reports or in intelligence documentation. 
  * **Hierarchy**: (person-to-person) - Defined as relationships between immediate superiors and subordinates in an organization. 
  
  
---

# Relationships Import

Familial:

```r
familial &lt;- read.csv(here::here("data/Familial.csv"), header = TRUE)
```

Financial:

```r
financial &lt;- read.csv(here::here("data/Financial.csv"), header = TRUE)
```

Friendship:

```r
friendship &lt;- read.csv(here::here("data/Friendship.csv"), header = TRUE)
```

Hierarchy:

```r
hierarchy &lt;- read.csv(here::here("data/Hierarchy.csv"), header = TRUE)
```


---

# Building Networks

First, install the package:

```r
install.packages("igraph")
```

Now load the package:

```r
library(igraph)
```

Create an **igraph** graph:

```r
familialNet &lt;- igraph::graph_from_data_frame(familial,
                                     directed = FALSE) 
```


---

# Familial Network Object


```r
familialNet
```

```
## IGRAPH c1854a6 UN-- 22 30 -- 
## + attr: name (v/c), Relationship (e/c)
## + edges from c1854a6 (vertex names):
##  [1] Adonis   --Boxcar    Adonis   --Ghost     Adonis   --Jelly    
##  [4] Bananas  --Blue Eyes Bananas  --Brains    Bananas  --Slingshot
##  [7] Bananas  --Gremlin   Bat G.   --Big G.    Bat G.   --Blaze    
## [10] Big G.   --Blaze     Boots    --Fat Boy   Boots    --Freckles 
## [13] Boots    --Icepick   Boots    --Repo Girl Boxcar   --Ghost    
## [16] Boxcar   --Jelly     Brains   --Slingshot Brains   --Gremlin  
## [19] Fat Boy  --Freckles  Fat Boy  --Icepick   Fat Boy  --Repo Girl
## [22] Slingshot--Gremlin   Freckles --Icepick   Freckles --Repo Girl
## + ... omitted several edges
```

--
  * `name` listed as `(v/c)`, which denotes a vertex-level character attributes

--
  * `Relationship` listed as `(e/c)` or edge-level character attributes


---

# Familial Network Edges


```r
E(familialNet)
```

```
## + 30/30 edges from c1854a6 (vertex names):
##  [1] Adonis   --Boxcar      Adonis   --Ghost       Adonis   --Jelly      
##  [4] Bananas  --Blue Eyes   Bananas  --Brains      Bananas  --Slingshot  
##  [7] Bananas  --Gremlin     Bat G.   --Big G.      Bat G.   --Blaze      
## [10] Big G.   --Blaze       Boots    --Fat Boy     Boots    --Freckles   
## [13] Boots    --Icepick     Boots    --Repo Girl   Boxcar   --Ghost      
## [16] Boxcar   --Jelly       Brains   --Slingshot   Brains   --Gremlin    
## [19] Fat Boy  --Freckles    Fat Boy  --Icepick     Fat Boy  --Repo Girl  
## [22] Slingshot--Gremlin     Freckles --Icepick     Freckles --Repo Girl  
## [25] Ghost    --Jelly       Goldie   --Pookey      Goldie   --O.G.       
## [28] Pookey   --O.G.        Icepick  --Repo Girl   Snake    --Sonny Black
```


```r
ecount(familialNet)
```

```
## [1] 30
```


---

# Familial Network Nodes


```r
V(familialNet)
```

```
## + 22/22 vertices, named, from c1854a6:
##  [1] Adonis      Bananas     Bat G.      Big G.      Boots      
##  [6] Boxcar      Brains      Fat Boy     Slingshot   Freckles   
## [11] Ghost       Goldie      Pookey      Icepick     Snake      
## [16] Jelly       Blue Eyes   Gremlin     Blaze       Repo Girl  
## [21] O.G.        Sonny Black
```


```r
vcount(familialNet)
```

```
## [1] 22
```


```r
V(familialNet)$name
```

```
##  [1] "Adonis"      "Bananas"     "Bat G."      "Big G."      "Boots"      
##  [6] "Boxcar"      "Brains"      "Fat Boy"     "Slingshot"   "Freckles"   
## [11] "Ghost"       "Goldie"      "Pookey"      "Icepick"     "Snake"      
## [16] "Jelly"       "Blue Eyes"   "Gremlin"     "Blaze"       "Repo Girl"  
## [21] "O.G."        "Sonny Black"
```


---

# Familial Network Visualization


```r
plot.igraph(familialNet)
```
.center[
![](SNAinR_files/figure-html/unnamed-chunk-17-1.png)&lt;!-- --&gt;
]


---

# Familial Network Visualization

.pull-left[

```r
plot.igraph(familialNet,
            # Nodes ====
            vertex.label = NA,
            vertex.color = "blue",
            vertex.size = 5,
            # Edge ====
            edge.color = "black",
            edge.arrow.size = 0,
            edge.curved = TRUE,
            # Other ====
            margin = .01,
            frame = FALSE,
            main = "Familial Network"
            )
```

.center[
Arguments = ð
]
]

.pull-right[
![](SNAinR_files/figure-html/unnamed-chunk-19-1.png)&lt;!-- --&gt;
]


---

#So What?

--
.center[
Automation! Automation! Automation! 
]

--
.pull-left[

```r
read.csv(here::here("data/Financial.csv"), header = TRUE) %&gt;%
  igraph::graph_from_data_frame(directed = FALSE) %&gt;%
  igraph::plot.igraph(vertex.label=NA,
            vertex.color="blue",
            vertex.size=5,
            edge.color="black",
            edge.arrow.size=0,
            edge.curved=TRUE, 
            margin = .01,
            frame = FALSE
            )
```

.center[
ð¹
]
]
.pull-right[
![](SNAinR_files/figure-html/unnamed-chunk-21-1.png)&lt;!-- --&gt;
]


---

# Automation! Automation! Automation!

.center[
![](images/multipleCSVs.png)
]


---

# Automation! Automation! Automation!

.pull-left[

```r
files &lt;- list.files(path="data/onemode/",
                    pattern = "\\.csv$",
                    full.names = TRUE)
files %&gt;%
  purrr::map_dfr(read_csv) %&gt;%
  igraph::graph_from_data_frame(directed = FALSE) %&gt;%
  igraph::set_edge_attr("color",
                          value = dplyr::case_when(
                            E(.)$Relationship == "Familial" ~ "#d7191c",
                            E(.)$Relationship == "Financial" ~ "#fdae61",
                            E(.)$Relationship == "Friendship" ~ "#abd9e9",
                            E(.)$Relationship == "Hierarchy" ~ "#2c7bb6"
                          )) %&gt;%
  igraph::plot.igraph(vertex.label=NA,
                      vertex.color="grey",
                      vertex.size=5,
                      edge.arrow.size=0,
                      edge.curved=TRUE, 
                      margin = .01
                      )
```
]
.pull-right[
![](SNAinR_files/figure-html/unnamed-chunk-23-1.png)&lt;!-- --&gt;
]


---

# Metrics in Igraph

Q: Now that you have data, how can you analyze it?

--
A: Start with network-level measures

Metric  | Explanation | Command
--------|-------------|---------
Density  | Number of observed ties divided by possible number of ties  | `edge_density()`
Average Degree  | Sum of ties divided by number of actors | `mean(degree())`
Global Clustering  | Sum of each actor's clustering divided by number of actors  | `transitivity()`


---

#Quick Note on Commands


```r
g &lt;- list.files(path="data/onemode/",
                    pattern = "*.csv",
                    full.names = TRUE) %&gt;%
  purrr::map_dfr(read_csv) %&gt;%
  igraph::graph_from_data_frame(directed = FALSE)
```



```r
edge_density(g, loops = FALSE) # Simple Command
```

```
## [1] 0.1188406
```


```r
g_density&lt;-edge_density(g, loops = FALSE) # Assigning object
```


```r
g_density# Calling "g_density" object
```

```
## [1] 0.1188406
```

---

# Network-Level Measures


```r
g &lt;- list.files(path="data/onemode/",
                    pattern = "*.csv",
                    full.names = TRUE) %&gt;%
  purrr::map_dfr(read_csv) %&gt;%
  igraph::graph_from_data_frame(directed = FALSE) %&gt;%
  igraph::set.graph.attribute("density", edge_density(.)) %&gt;%
  igraph::set.graph.attribute("avg_degree", mean(degree(.))) %&gt;%
  igraph::set.graph.attribute("avg_clu_coef", transitivity(., "average")) 
```


```r
graph_attr(g, "density") 
```

```
## [1] 0.1188406
```


```r
graph_attr(g, "avg_degree")
```

```
## [1] 5.347826
```


```r
graph_attr(g, "avg_clu_coef")
```

```
## [1] 0.6436332
```


---

# Network-Level Measures Report


```r
data.frame(
  "Density" = graph_attr(g, "density"),
  "Avg. Degree" = graph_attr(g, "avg_degree"),
  "Avg. Clustering Coefficient" = graph_attr(g, "avg_degree")
) %&gt;%
  knitr::kable(format = "html", digits = 3, caption = "Demo Table") %&gt;%
  kableExtra::kable_styling(bootstrap_options = c("striped", "condensed")) %&gt;%
  kableExtra::add_footnote(label = "table footnote", notation = "number")
```

&lt;table class="table table-striped table-condensed" style="margin-left: auto; margin-right: auto;"&gt;
&lt;caption&gt;Demo Table&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; Density &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Avg..Degree &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Avg..Clustering.Coefficient &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 0.119 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5.348 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5.348 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;tfoot&gt;
&lt;tr&gt;
&lt;td style = 'padding: 0; border:0;' colspan='100%'&gt;&lt;sup&gt;1&lt;/sup&gt; table footnote&lt;/td&gt;
&lt;/tr&gt;
&lt;/tfoot&gt;
&lt;/table&gt;


---

# Metrics in Igraph

Q: Now that I've looked at network-level measures, what do I do?

--

A: Calculate vertex-level metrics.

Metric  | Explanation | Command
--------|-------------|---------
Degree  | Count of actor's ties  | `degree()`
Eigenvector  | Weights an actor's centrality by the centrality of its neighbors  | `evcent()`
Betweenness  | How often each actor lies on the shortest path between all other actors  | `betweenness()`


---

# Vertex-Level Measures


```r
g %&gt;%
  igraph::set.vertex.attribute("degree", value=degree(.)) %&gt;%
  igraph::set.vertex.attribute("eigenvector", value=round(evcent(.)$vector, 2)) %&gt;%
  igraph::set.vertex.attribute("betweenness", value=round(betweenness(.), 2)) %&gt;%
  igraph::get.data.frame("vertices") %&gt;%
  DT::datatable(rownames = F,
                options = list(
                  pageLength=10,
                  dom="tp"
                ))
```

<div id="htmlwidget-9a995807a0941f3a6747" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-9a995807a0941f3a6747">{"x":{"filter":"none","data":[["Adonis","Bananas","Bat G.","Big G.","Boots","Boxcar","Brains","Fat Boy","Slingshot","Freckles","Ghost","Goldie","Pookey","Icepick","Snake","Animal","Ant","Bugs","Bloodhound","Cranky","Enforcer","O.G.","4 Stroke","The Barber","Bow Wow","The Dentist","Frosty","Blood Messiah","Baby Face","Book Collector","Blue Eyes","Dapper Don","Fast Trigger","Scratch","Shadow","Jelly","Gremlin","Blaze","Repo Girl","Sonny Black","Crusier","Little Red","Ha-Ha","Clown","Smiley","Smoke"],[6,9,8,4,9,6,6,11,9,12,6,6,4,8,6,6,3,1,11,3,2,31,3,2,3,6,5,1,2,1,4,1,2,1,4,6,6,4,8,2,6,4,4,1,2,1],[0,0.31,0.25,0.07,0.66,0,0.19,0.74,0.34,0.69,0,0.43,0.32,0.6,0.27,0.15,0.13,0.02,0.41,0.24,0.15,1,0.18,0.16,0.27,0.32,0.31,0.01,0.04,0.11,0.18,0.08,0.16,0.01,0.07,0,0.19,0.07,0.6,0.06,0.35,0.06,0.3,0,0.14,0.11],[0,35.8,79,0,0,0,0,211.2,42.97,79,0,1.5,0,0,54.4,5,31.67,0,43.23,3.5,0,638.63,0,0,0,118.33,0.67,0,40,0,40,0,0,0,40,0,0,0,0,0,93.6,41.5,0,0,0,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>name<\/th>\n      <th>degree<\/th>\n      <th>eigenvector<\/th>\n      <th>betweenness<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"dom":"tp","columnDefs":[{"className":"dt-right","targets":[1,2,3]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>


---

# Interactive Visuals

First, install the package:

```r
install.packages("visNetwork")
```

Now load the package:

```r
library(visNetwork)
```


---

# visNetwork with Igraph


```r
visNetwork::visIgraph(g) 
```

.center[
<div id="htmlwidget-e7f9cce4f3c961e97390" style="width:504px;height:504px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-e7f9cce4f3c961e97390">{"x":{"nodes":{"id":["Adonis","Bananas","Bat G.","Big G.","Boots","Boxcar","Brains","Fat Boy","Slingshot","Freckles","Ghost","Goldie","Pookey","Icepick","Snake","Animal","Ant","Bugs","Bloodhound","Cranky","Enforcer","O.G.","4 Stroke","The Barber","Bow Wow","The Dentist","Frosty","Blood Messiah","Baby Face","Book Collector","Blue Eyes","Dapper Don","Fast Trigger","Scratch","Shadow","Jelly","Gremlin","Blaze","Repo Girl","Sonny Black","Crusier","Little Red","Ha-Ha","Clown","Smiley","Smoke"],"label":["Adonis","Bananas","Bat G.","Big G.","Boots","Boxcar","Brains","Fat Boy","Slingshot","Freckles","Ghost","Goldie","Pookey","Icepick","Snake","Animal","Ant","Bugs","Bloodhound","Cranky","Enforcer","O.G.","4 Stroke","The Barber","Bow Wow","The Dentist","Frosty","Blood Messiah","Baby Face","Book Collector","Blue Eyes","Dapper Don","Fast Trigger","Scratch","Shadow","Jelly","Gremlin","Blaze","Repo Girl","Sonny Black","Crusier","Little Red","Ha-Ha","Clown","Smiley","Smoke"],"x":[-0.947173875974158,-0.310424885740626,-0.0412308555902252,-0.0298471567596086,0.797114627953851,-1,-0.460910458898843,0.555089021479003,-0.302708315663747,0.799438697898784,-0.864560595669079,0.0249967547216718,-0.0797718747671446,0.6836360472505,0.0866652215958965,0.264496860560877,0.478442106355071,-0.342631374515481,-0.00598232913735641,0.308898396393559,1,0.0499462239644659,0.257349689218758,-0.26614282851271,-0.127427536103489,0.286696939791821,0.171912213873596,0.336164249217044,0.571842687661905,0.0415183130709385,-0.201541275714606,0.829631110797425,-0.261020129006873,0.925182390438913,0.333948029114693,-0.919005507444306,-0.497787847476171,-0.14478267886859,0.715362392302282,0.0233528037858126,0.300207704097692,0.651787903257774,-0.124281676568121,0.728678069895981,0.113907662629394,-0.287374136029249],"y":[-0.168726159120045,0.247914567125626,-0.682411137687478,-1,-0.373980869312025,-0.290109708623212,0.347920046607847,-0.293053471152829,0.111099925561889,-0.526583487724969,-0.270342523863168,-0.418396656131294,-0.435683876574938,-0.511885558138638,0.357707419388612,0.487086711861122,0.0607513056961742,0.762384938761423,-0.184805309212212,-0.23434944364427,-0.590524879679908,-0.124334675046958,-0.494329193112038,-0.140174830372678,-0.256540749428951,0.0492130057607827,-0.346666269556337,1,0.462454840840737,0.194771790475291,0.395121450640229,-0.866408555866587,-0.311339829934154,0.308534123231023,0.670328947353306,-0.388394448095797,0.235809307323395,-0.974397641596951,-0.394822593680812,0.678533019095537,0.19301866460017,0.178897949343494,0.0131693485648998,0.734527676869008,-0.648795759672545,-0.508497808925921]},"edges":{"from":["Adonis","Adonis","Adonis","Bananas","Bananas","Bananas","Bananas","Bat G.","Bat G.","Big G.","Boots","Boots","Boots","Boots","Boxcar","Boxcar","Brains","Brains","Fat Boy","Fat Boy","Fat Boy","Slingshot","Freckles","Freckles","Ghost","Goldie","Goldie","Pookey","Icepick","Snake","Animal","Snake","Animal","Ant","Bugs","Bloodhound","Bloodhound","Cranky","Freckles","Fat Boy","Fat Boy","Slingshot","O.G.","Snake","O.G.","4 Stroke","Adonis","Adonis","Adonis","Bananas","Bananas","Bananas","Bananas","O.G.","Bat G.","Bat G.","Big G.","Boots","Boots","Boots","Boots","Bloodhound","Bloodhound","Slingshot","O.G.","Boxcar","Boxcar","Brains","Brains","Fat Boy","O.G.","Fat Boy","Fat Boy","Fat Boy","Slingshot","Freckles","Freckles","O.G.","Ghost","Goldie","Goldie","Pookey","O.G.","Icepick","Snake","4 Stroke","O.G.","Blood Messiah","Animal","Snake","Animal","Ant","Ant","Baby Face","The Dentist","Bananas","Bloodhound","Bat G.","Bat G.","Bat G.","Bat G.","O.G.","Boots","Bloodhound","Bloodhound","Bloodhound","Bloodhound","O.G.","O.G.","Freckles","O.G.","The Dentist","Freckles","O.G.","Slingshot","O.G.","Goldie","O.G.","O.G.","Snake","O.G.","Scratch","Shadow"],"to":["Boxcar","Ghost","Jelly","Blue Eyes","Brains","Slingshot","Gremlin","Big G.","Blaze","Blaze","Fat Boy","Freckles","Icepick","Repo Girl","Ghost","Jelly","Slingshot","Gremlin","Freckles","Icepick","Repo Girl","Gremlin","Icepick","Repo Girl","Jelly","Pookey","O.G.","O.G.","Repo Girl","Sonny Black","Shadow","Animal","Crusier","Little Red","Blue Eyes","Cranky","Ha-Ha","O.G.","Enforcer","O.G.","Crusier","Ha-Ha","Ha-Ha","O.G.","Crusier","Frosty","Boxcar","Ghost","Jelly","Blue Eyes","Brains","Slingshot","Gremlin","The Barber","Big G.","Blaze","Blaze","Fat Boy","Freckles","Icepick","Repo Girl","Bow Wow","The Dentist","Bloodhound","Bow Wow","Ghost","Jelly","Slingshot","Gremlin","Cranky","The Dentist","Freckles","Icepick","Repo Girl","Gremlin","Icepick","Repo Girl","Frosty","Jelly","Pookey","O.G.","O.G.","Ha-Ha","Repo Girl","Sonny Black","Frosty","4 Stroke","Shadow","Shadow","Animal","Crusier","O.G.","Little Red","Clown","Baby Face","O.G.","The Barber","Bloodhound","Goldie","O.G.","Smiley","Book Collector","Freckles","The Dentist","Fast Trigger","Frosty","O.G.","Blue Eyes","Bow Wow","Dapper Don","The Dentist","Little Red","Enforcer","Fast Trigger","O.G.","Frosty","O.G.","Smiley","Smoke","O.G.","Crusier","Little Red","Crusier"],"Relationship":["Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Financial","Financial","Financial","Financial","Financial","Financial","Financial","Financial","Financial","Financial","Financial","Financial","Financial","Financial","Financial","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"stabilization":false},"height":"80%","width":"140%","interaction":{"dragNodes":true,"dragView":true,"keyboard":true,"navigationButtons":true,"zoomView":true}},"groups":null,"width":null,"height":null,"idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)"},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"highlight":{"enabled":false,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
]


---

# visNetwork with Igraph Visualization Arguments


```r
g &lt;- g %&gt;%
  # Node attributes ====
  set.vertex.attribute("color.background", value = "grey") %&gt;%
  set.vertex.attribute("color.border", value = "black") %&gt;%
  set.vertex.attribute("borderWidth", value = 2) %&gt;% 
  set.vertex.attribute("size", value = degree(.)) %&gt;% 
  set.vertex.attribute("label", value = V(.)$name) %&gt;%
  # Edge attributes ====
  set.edge.attribute("width", value = scales::rescale(edge_betweenness(.), c(2,10))) %&gt;%
  set.edge.attribute("color", value = "slategrey") %&gt;%
  set.edge.attribute("smooth", value = FALSE) %&gt;%
  set.edge.attribute("shadow", value = TRUE)
```


---

# visNetwork with Igraph Visualization

.center[
<div id="htmlwidget-3bdc5839e2a524495d7a" style="width:504px;height:504px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-3bdc5839e2a524495d7a">{"x":{"nodes":{"id":["Adonis","Bananas","Bat G.","Big G.","Boots","Boxcar","Brains","Fat Boy","Slingshot","Freckles","Ghost","Goldie","Pookey","Icepick","Snake","Animal","Ant","Bugs","Bloodhound","Cranky","Enforcer","O.G.","4 Stroke","The Barber","Bow Wow","The Dentist","Frosty","Blood Messiah","Baby Face","Book Collector","Blue Eyes","Dapper Don","Fast Trigger","Scratch","Shadow","Jelly","Gremlin","Blaze","Repo Girl","Sonny Black","Crusier","Little Red","Ha-Ha","Clown","Smiley","Smoke"],"color.background":["grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey"],"color.border":["black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black"],"borderWidth":[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],"size":[6,9,8,4,9,6,6,11,9,12,6,6,4,8,6,6,3,1,11,3,2,31,3,2,3,6,5,1,2,1,4,1,2,1,4,6,6,4,8,2,6,4,4,1,2,1],"label":["Adonis","Bananas","Bat G.","Big G.","Boots","Boxcar","Brains","Fat Boy","Slingshot","Freckles","Ghost","Goldie","Pookey","Icepick","Snake","Animal","Ant","Bugs","Bloodhound","Cranky","Enforcer","O.G.","4 Stroke","The Barber","Bow Wow","The Dentist","Frosty","Blood Messiah","Baby Face","Book Collector","Blue Eyes","Dapper Don","Fast Trigger","Scratch","Shadow","Jelly","Gremlin","Blaze","Repo Girl","Sonny Black","Crusier","Little Red","Ha-Ha","Clown","Smiley","Smoke"],"x":[0.760707228764663,-0.225159699842671,-0.721645915310801,-1,0.48845742725684,0.78834649757403,-0.28446634123138,0.356424985748818,-0.321302115415906,0.617371145522286,0.889080382745467,-0.465558865897689,-0.364725231932342,0.522659928581694,0.212511114764099,0.473064304699133,-0.606115495024953,0.077710926553431,-0.348579265926128,0.0491514281219678,0.853035965969402,-0.202984839972673,-0.0800450108363746,-0.521202226531902,-0.0633684287677216,-0.415858848239196,-0.199912695282886,1,-0.402278764344823,-0.0619663936130377,-0.0340340470828666,0.646062729435251,-0.545537168881169,-0.895334514853761,0.681442087022848,0.918589820247807,-0.398368356488508,-0.9468352901088,0.619658404963467,0.416869265926172,0.26714326427152,-0.721007944533621,-0.204303312654882,-0.320482180031825,-0.699644382514433,-0.277314398068658],"y":[-0.966045633767542,-0.650701558514388,-0.273500922165565,-0.330574073283573,0.5202677697324,-0.833981912664051,-0.840280080052951,0.287450981994258,-0.552535973948059,0.541526287824888,-0.966942901127716,-0.187331746866255,-0.298252834948367,0.417696820038428,-0.284870428615696,-0.192713304436591,0.289104586813196,-1,-0.097746103156372,0.0827574499558654,0.623679028661385,-0.0935011051386263,0.227261072246195,-0.348953411884727,-0.196173576177445,0.233388209750617,0.110610541854132,-0.133969472930987,0.716381792593793,0.39070985578416,-0.637600002152441,0.852552938765947,0.0492458441560251,0.698374867121959,-0.138787166134709,-0.833401580796289,-0.804667031103654,-0.457824198773694,0.380869573846537,-0.492050856761534,-0.0576055182440472,0.479386884041555,-0.341088762226776,1,-0.0820288158464487,0.372810865841947]},"edges":{"from":["Adonis","Adonis","Adonis","Bananas","Bananas","Bananas","Bananas","Bat G.","Bat G.","Big G.","Boots","Boots","Boots","Boots","Boxcar","Boxcar","Brains","Brains","Fat Boy","Fat Boy","Fat Boy","Slingshot","Freckles","Freckles","Ghost","Goldie","Goldie","Pookey","Icepick","Snake","Animal","Snake","Animal","Ant","Bugs","Bloodhound","Bloodhound","Cranky","Freckles","Fat Boy","Fat Boy","Slingshot","O.G.","Snake","O.G.","4 Stroke","Adonis","Adonis","Adonis","Bananas","Bananas","Bananas","Bananas","O.G.","Bat G.","Bat G.","Big G.","Boots","Boots","Boots","Boots","Bloodhound","Bloodhound","Slingshot","O.G.","Boxcar","Boxcar","Brains","Brains","Fat Boy","O.G.","Fat Boy","Fat Boy","Fat Boy","Slingshot","Freckles","Freckles","O.G.","Ghost","Goldie","Goldie","Pookey","O.G.","Icepick","Snake","4 Stroke","O.G.","Blood Messiah","Animal","Snake","Animal","Ant","Ant","Baby Face","The Dentist","Bananas","Bloodhound","Bat G.","Bat G.","Bat G.","Bat G.","O.G.","Boots","Bloodhound","Bloodhound","Bloodhound","Bloodhound","O.G.","O.G.","Freckles","O.G.","The Dentist","Freckles","O.G.","Slingshot","O.G.","Goldie","O.G.","O.G.","Snake","O.G.","Scratch","Shadow"],"to":["Boxcar","Ghost","Jelly","Blue Eyes","Brains","Slingshot","Gremlin","Big G.","Blaze","Blaze","Fat Boy","Freckles","Icepick","Repo Girl","Ghost","Jelly","Slingshot","Gremlin","Freckles","Icepick","Repo Girl","Gremlin","Icepick","Repo Girl","Jelly","Pookey","O.G.","O.G.","Repo Girl","Sonny Black","Shadow","Animal","Crusier","Little Red","Blue Eyes","Cranky","Ha-Ha","O.G.","Enforcer","O.G.","Crusier","Ha-Ha","Ha-Ha","O.G.","Crusier","Frosty","Boxcar","Ghost","Jelly","Blue Eyes","Brains","Slingshot","Gremlin","The Barber","Big G.","Blaze","Blaze","Fat Boy","Freckles","Icepick","Repo Girl","Bow Wow","The Dentist","Bloodhound","Bow Wow","Ghost","Jelly","Slingshot","Gremlin","Cranky","The Dentist","Freckles","Icepick","Repo Girl","Gremlin","Icepick","Repo Girl","Frosty","Jelly","Pookey","O.G.","O.G.","Ha-Ha","Repo Girl","Sonny Black","Frosty","4 Stroke","Shadow","Shadow","Animal","Crusier","O.G.","Little Red","Clown","Baby Face","O.G.","The Barber","Bloodhound","Goldie","O.G.","Smiley","Book Collector","Freckles","The Dentist","Fast Trigger","Frosty","O.G.","Blue Eyes","Bow Wow","Dapper Don","The Dentist","Little Red","Enforcer","Fast Trigger","O.G.","Frosty","O.G.","Smiley","Smoke","O.G.","Crusier","Little Red","Crusier"],"Relationship":["Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Familial","Financial","Financial","Financial","Financial","Financial","Financial","Financial","Financial","Financial","Financial","Financial","Financial","Financial","Financial","Financial","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Friendship","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate","Superior-Subordinate"],"width":[2,2,2,2.12815533980583,2.33203883495146,2.0537216828479,2.33203883495146,2.75728155339806,2.75728155339806,2,2.67961165048544,2.01941747572816,2,2,2,2,2.40582524271845,2,4.07766990291262,2.67961165048544,2.67961165048544,2.40582524271845,2.03883495145631,2.03883495145631,2,2.02912621359223,2.45307443365696,2.72815533980583,2,2.77669902912621,2.09708737864078,2.39611650485437,2.43883495145631,2.66343042071197,3.57281553398058,2.42071197411003,2.16699029126214,2.95016181229773,2.77669902912621,10,3.11456310679612,2.11650485436893,2.61553398058252,3.67766990291262,3.9495145631068,2.01294498381877,2,2,2,2.12815533980583,2.33203883495146,2.0537216828479,2.33203883495146,3.26860841423948,2.75728155339806,2.75728155339806,2,2.67961165048544,2.01941747572816,2,2,2.19546925566343,2.50809061488673,2.64466019417476,2.66925566343042,2,2,2.40582524271845,2,2.43495145631068,4.36245954692557,4.07766990291262,2.67961165048544,2.67961165048544,2.40582524271845,2.03883495145631,2.03883495145631,2.64983818770227,2,2.02912621359223,2.45307443365696,2.72815533980583,2.61553398058252,2,2.77669902912621,2.01294498381877,3.50809061488673,3.57281553398058,2.09708737864078,2.39611650485437,2.43883495145631,4.66666666666667,2.66343042071197,3.57281553398058,5.0873786407767,4.50614886731392,2.28478964401295,2.80582524271845,2.1747572815534,5.43689320388349,2.12621359223301,3.57281553398058,2.01941747572816,2.50809061488673,2.28478964401295,2.22135922330097,2.6957928802589,4.79223300970874,2.66925566343042,3.57281553398058,4.36245954692557,3.83818770226537,2.77669902912621,3.26860841423948,4.26278317152104,2.64983818770227,2.45307443365696,3.42718446601942,3.57281553398058,3.67766990291262,3.9495145631068,3.57281553398058,4.85436893203883],"color":["slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey","slategrey"],"smooth":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false],"shadow":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"stabilization":false},"height":"100%","width":"140%","interaction":{"dragNodes":true,"dragView":true,"keyboard":true,"navigationButtons":true,"zoomView":true}},"groups":null,"width":null,"height":null,"idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)"},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"highlight":{"enabled":false,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
]


---
&lt;br&gt;
.center[
### Questions?
]

![](images/wanna_see_the_code.png)

Dan Cunningham - dtcunnin@nps.edu

Christopher Callaghan - cjcallag@nps.edu
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
